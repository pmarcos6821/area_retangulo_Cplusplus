<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conversor de Arquivos para PDF</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.2/mammoth.browser.min.js"></script>
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100%;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: 700;
        }

        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .content {
            padding: 40px;
        }

        .upload-section {
            background: #f8f9ff;
            border: 3px dashed #4facfe;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            transition: all 0.3s ease;
        }

        .upload-section:hover {
            border-color: #00f2fe;
            background: #f0f4ff;
        }

        .upload-section.dragover {
            border-color: #00f2fe;
            background: #e8f2ff;
            transform: scale(1.02);
        }

        .upload-icon {
            font-size: 4rem;
            color: #4facfe;
            margin-bottom: 20px;
        }

        .file-input {
            display: none;
        }

        .upload-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
        }

        .upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(79, 172, 254, 0.3);
        }

        .file-list {
            margin-top: 30px;
        }

        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #f8f9ff;
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #4facfe;
        }

        .file-info {
            display: flex;
            align-items: center;
            flex: 1;
        }

        .file-icon {
            font-size: 1.5rem;
            margin-right: 15px;
        }

        .file-name {
            font-weight: 600;
            color: #333;
        }

        .file-size {
            color: #666;
            font-size: 0.9rem;
            margin-left: 10px;
        }

        .status {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .status.pending {
            background: #fff3cd;
            color: #856404;
        }

        .status.converting {
            background: #d1ecf1;
            color: #0c5460;
        }

        .status.completed {
            background: #d4edda;
            color: #155724;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
        }

        .convert-btn {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 30px;
            width: 100%;
        }

        .convert-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(17, 153, 142, 0.3);
        }

        .convert-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 20px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);
            width: 0%;
            transition: width 0.3s ease;
        }

        .download-section {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9ff;
            border-radius: 15px;
            text-align: center;
        }

        .download-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(102, 126, 234, 0.3);
        }

        .demo-notice {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
        }

        .demo-notice strong {
            color: #856404;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìÑ Conversor para PDF</h1>
            <p>Converta seus arquivos Excel e Word para PDF facilmente</p>
        </div>

        <div class="content">
            <div class="demo-notice">
                <strong>Demo:</strong> Esta √© uma vers√£o demonstrativa. A convers√£o funciona localmente no seu navegador para arquivos Excel simples e documentos Word b√°sicos.
            </div>

            <div class="upload-section" id="uploadSection">
                <div class="upload-icon">üìÅ</div>
                <h3>Selecione os arquivos para converter</h3>
                <p>Arraste e solte arquivos Excel (.xlsx, .xls) e Word (.docx) aqui<br>ou clique no bot√£o abaixo</p>
                <input type="file" id="fileInput" class="file-input" multiple accept=".xlsx,.xls,.docx">
                <button class="upload-btn" onclick="document.getElementById('fileInput').click()">
                    üìÇ Escolher Arquivos
                </button>
            </div>

            <div class="file-list" id="fileList"></div>

            <button class="convert-btn" id="convertBtn" onclick="convertFiles()" disabled>
                üîÑ Converter para PDF
            </button>

            <div class="progress-bar" id="progressBar" style="display: none;">
                <div class="progress-fill" id="progressFill"></div>
            </div>

            <div class="download-section" id="downloadSection" style="display: none;">
                <h3>üì• Arquivos Convertidos</h3>
                <p>Clique nos bot√µes abaixo para baixar seus PDFs</p>
                <div id="downloadButtons"></div>
            </div>
        </div>
    </div>

    <script>
        let selectedFiles = [];
        let convertedFiles = [];

        // Configurar drag and drop
        const uploadSection = document.getElementById('uploadSection');
        const fileInput = document.getElementById('fileInput');

        uploadSection.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadSection.classList.add('dragover');
        });

        uploadSection.addEventListener('dragleave', () => {
            uploadSection.classList.remove('dragover');
        });

        uploadSection.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadSection.classList.remove('dragover');
            handleFiles(e.dataTransfer.files);
        });

        fileInput.addEventListener('change', (e) => {
            handleFiles(e.target.files);
        });

        function handleFiles(files) {
            selectedFiles = Array.from(files).filter(file => {
                const ext = file.name.toLowerCase();
                return ext.endsWith('.xlsx') || ext.endsWith('.xls') || ext.endsWith('.docx');
            });

            displayFileList();
            document.getElementById('convertBtn').disabled = selectedFiles.length === 0;
        }

        function displayFileList() {
            const fileList = document.getElementById('fileList');

            if (selectedFiles.length === 0) {
                fileList.innerHTML = '';
                return;
            }

            fileList.innerHTML = selectedFiles.map((file, index) => {
                const icon = getFileIcon(file.name);
                const size = formatFileSize(file.size);

                return `
                    <div class="file-item">
                        <div class="file-info">
                            <span class="file-icon">${icon}</span>
                            <span class="file-name">${file.name}</span>
                            <span class="file-size">${size}</span>
                        </div>
                        <span class="status pending" id="status-${index}">Aguardando</span>
                    </div>
                `;
            }).join('');
        }

        function getFileIcon(filename) {
            const ext = filename.toLowerCase();
            if (ext.endsWith('.xlsx') || ext.endsWith('.xls')) return 'üìä';
            if (ext.endsWith('.docx')) return 'üìù';
            return 'üìÑ';
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        async function convertFiles() {
            const convertBtn = document.getElementById('convertBtn');
            const progressBar = document.getElementById('progressBar');
            const progressFill = document.getElementById('progressFill');

            convertBtn.disabled = true;
            progressBar.style.display = 'block';
            convertedFiles = [];

            for (let i = 0; i < selectedFiles.length; i++) {
                const file = selectedFiles[i];
                const statusElement = document.getElementById(`status-${i}`);

                try {
                    statusElement.textContent = 'Convertendo...';
                    statusElement.className = 'status converting';

                    const pdfBlob = await convertToPDF(file);
                    convertedFiles.push({
                        name: file.name.replace(/\.[^/.]+$/, '.pdf'),
                        blob: pdfBlob
                    });

                    statusElement.textContent = 'Conclu√≠do';
                    statusElement.className = 'status completed';
                } catch (error) {
                    console.error('Erro ao converter:', error);
                    statusElement.textContent = 'Erro';
                    statusElement.className = 'status error';
                }

                const progress = ((i + 1) / selectedFiles.length) * 100;
                progressFill.style.width = progress + '%';
            }

            showDownloadSection();
            convertBtn.disabled = false;
        }

        async function convertToPDF(file) {
            const ext = file.name.toLowerCase();

            if (ext.endsWith('.xlsx') || ext.endsWith('.xls')) {
                return await convertExcelToPDF(file);
            } else if (ext.endsWith('.docx')) {
                return await convertWordToPDF(file);
            }

            throw new Error('Formato n√£o suportado');
        }

        async function convertExcelToPDF(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const data = new Uint8Array(e.target.result);
                        const workbook = XLSX.read(data, {type: 'array'});

                        const { jsPDF } = window.jspdf;
                        const pdf = new jsPDF();

                        let yPosition = 20;

                        workbook.SheetNames.forEach((sheetName, sheetIndex) => {
                            if (sheetIndex > 0) {
                                pdf.addPage();
                                yPosition = 20;
                            }

                            pdf.setFontSize(16);
                            pdf.text(sheetName, 20, yPosition);
                            yPosition += 15;

                            const worksheet = workbook.Sheets[sheetName];
                            const jsonData = XLSX.utils.sheet_to_json(worksheet, {header: 1});

                            pdf.setFontSize(10);
                            jsonData.slice(0, 30).forEach((row, rowIndex) => {
                                if (yPosition > 270) {
                                    pdf.addPage();
                                    yPosition = 20;
                                }

                                const rowText = row.slice(0, 6).join(' | ');
                                if (rowText.trim()) {
                                    pdf.text(rowText.substring(0, 80), 20, yPosition);
                                    yPosition += 8;
                                }
                            });
                        });

                        const pdfBlob = pdf.output('blob');
                        resolve(pdfBlob);
                    } catch (error) {
                        reject(error);
                    }
                };
                reader.readAsArrayBuffer(file);
            });
        }

        async function convertWordToPDF(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    mammoth.extractRawText({arrayBuffer: e.target.result})
                        .then(function(result) {
                            const { jsPDF } = window.jspdf;
                            const pdf = new jsPDF();

                            const text = result.value;
                            const lines = pdf.splitTextToSize(text, 170);

                            let yPosition = 20;
                            lines.forEach(line => {
                                if (yPosition > 270) {
                                    pdf.addPage();
                                    yPosition = 20;
                                }
                                pdf.text(line, 20, yPosition);
                                yPosition += 7;
                            });

                            const pdfBlob = pdf.output('blob');
                            resolve(pdfBlob);
                        })
                        .catch(reject);
                };
                reader.readAsArrayBuffer(file);
            });
        }

        function showDownloadSection() {
            const downloadSection = document.getElementById('downloadSection');
            const downloadButtons = document.getElementById('downloadButtons');

            downloadButtons.innerHTML = convertedFiles.map((file, index) =>
                `<button class="download-btn" onclick="downloadFile(${index})">
                    üì• ${file.name}
                </button>`
            ).join('');

            downloadSection.style.display = 'block';
        }

        function downloadFile(index) {
            const file = convertedFiles[index];
            const url = URL.createObjectURL(file.blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = file.name;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98e0294d9181c075',t:'MTc2MDM3MjM5NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
